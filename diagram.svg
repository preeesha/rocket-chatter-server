<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.0 (20200518.1210)
 -->
<!-- Title: buildTables Pages: 1 -->
<svg width="3402pt" height="2220pt"
 viewBox="0.00 0.00 3401.60 2220.17" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2216.17)">
<title>buildTables</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2216.17 3397.6,-2216.17 3397.6,4 -4,4"/>
<!-- buildTable -->
<g id="node1" class="node">
<title>buildTable</title>
<polygon fill="none" stroke="black" points="906.32,-628.3 178.39,-628.3 178.39,-592.3 906.32,-592.3 906.32,-628.3"/>
<text text-anchor="middle" x="542.35" y="-606.1" font-family="Times,serif" font-size="14.00">buildTable(dbpath: string, env: Env, options: Options, iterator: IterableIterator&lt;Entry&gt;, meta: FileMetaData): Promise&lt;Status&gt;</text>
</g>
<!-- env -->
<g id="node2" class="node">
<title>env</title>
<polygon fill="none" stroke="black" points="66.24,-1137.57 -0.08,-1137.57 -0.08,-1101.57 66.24,-1101.57 66.24,-1137.57"/>
<text text-anchor="middle" x="33.08" y="-1115.37" font-family="Times,serif" font-size="14.00">env: Env</text>
</g>
<!-- buildTable&#45;&gt;env -->
<g id="edge1" class="edge">
<title>buildTable&#45;&gt;env</title>
<path fill="none" stroke="black" d="M524.23,-628.43C447.35,-705.3 148.1,-1004.56 58.54,-1094.12"/>
<polygon fill="black" stroke="black" points="55.85,-1091.85 51.25,-1101.4 60.8,-1096.8 55.85,-1091.85"/>
</g>
<!-- options -->
<g id="node3" class="node">
<title>options</title>
<polygon fill="none" stroke="black" points="368.25,-498.62 259.35,-498.62 259.35,-462.62 368.25,-462.62 368.25,-498.62"/>
<text text-anchor="middle" x="313.8" y="-476.42" font-family="Times,serif" font-size="14.00">options: Options</text>
</g>
<!-- buildTable&#45;&gt;options -->
<g id="edge2" class="edge">
<title>buildTable&#45;&gt;options</title>
<path fill="none" stroke="black" d="M510.57,-592.27C469.84,-569.16 399.15,-529.05 354.52,-503.72"/>
<polygon fill="black" stroke="black" points="356.1,-500.6 345.68,-498.71 352.65,-506.69 356.1,-500.6"/>
</g>
<!-- iterator -->
<g id="node4" class="node">
<title>iterator</title>
<polygon fill="none" stroke="black" points="630.19,-459.04 435.9,-459.04 435.9,-423.04 630.19,-423.04 630.19,-459.04"/>
<text text-anchor="middle" x="533.04" y="-436.84" font-family="Times,serif" font-size="14.00">iterator: IterableIterator&lt;Entry&gt;</text>
</g>
<!-- buildTable&#45;&gt;iterator -->
<g id="edge3" class="edge">
<title>buildTable&#45;&gt;iterator</title>
<path fill="none" stroke="black" d="M541.36,-592.19C539.74,-562.74 536.52,-504.27 534.6,-469.32"/>
<polygon fill="black" stroke="black" points="538.09,-469.07 534.04,-459.28 531.1,-469.46 538.09,-469.07"/>
</g>
<!-- meta -->
<g id="node5" class="node">
<title>meta</title>
<polygon fill="none" stroke="black" points="825.68,-495.55 698.54,-495.55 698.54,-459.55 825.68,-459.55 825.68,-495.55"/>
<text text-anchor="middle" x="762.11" y="-473.35" font-family="Times,serif" font-size="14.00">meta: FileMetaData</text>
</g>
<!-- buildTable&#45;&gt;meta -->
<g id="edge4" class="edge">
<title>buildTable&#45;&gt;meta</title>
<path fill="none" stroke="black" d="M572.45,-592.12C611.63,-568.45 680.17,-527.05 723.24,-501.03"/>
<polygon fill="black" stroke="black" points="725.28,-503.89 732.03,-495.72 721.66,-497.9 725.28,-503.89"/>
</g>
<!-- tableFilename -->
<g id="node20" class="node">
<title>tableFilename</title>
<ellipse fill="none" stroke="black" cx="1051.63" cy="-1119.57" rx="65.99" ry="18"/>
<text text-anchor="middle" x="1051.63" y="-1115.37" font-family="Times,serif" font-size="14.00">tableFilename</text>
</g>
<!-- buildTable&#45;&gt;tableFilename -->
<g id="edge7" class="edge">
<title>buildTable&#45;&gt;tableFilename</title>
<path fill="none" stroke="black" d="M560.48,-628.43C637.61,-705.56 938.62,-1006.57 1027.06,-1095.01"/>
<polygon fill="black" stroke="black" points="1024.7,-1097.59 1034.24,-1102.19 1029.65,-1092.65 1024.7,-1097.59"/>
</g>
<!-- getTableFilename -->
<g id="node6" class="node">
<title>getTableFilename</title>
<polygon fill="none" stroke="black" points="542.35,-1646.85 303.4,-1628.85 542.35,-1610.85 781.3,-1628.85 542.35,-1646.85"/>
<text text-anchor="middle" x="542.35" y="-1624.65" font-family="Times,serif" font-size="14.00">getTableFilename(dbpath, meta.number)</text>
</g>
<!-- env&#45;&gt;getTableFilename -->
<g id="edge5" class="edge">
<title>env&#45;&gt;getTableFilename</title>
<path fill="none" stroke="black" d="M51.2,-1137.7C128.51,-1215 430.69,-1517.19 518.38,-1604.87"/>
<polygon fill="black" stroke="black" points="515.94,-1607.39 525.49,-1611.98 520.89,-1602.44 515.94,-1607.39"/>
</g>
<!-- getTableFilename&#45;&gt;tableFilename -->
<g id="edge6" class="edge">
<title>getTableFilename&#45;&gt;tableFilename</title>
<path fill="none" stroke="black" d="M559.3,-1611.9C634.43,-1536.77 937.69,-1233.51 1026.86,-1144.34"/>
<polygon fill="black" stroke="black" points="1029.5,-1146.65 1034.09,-1137.1 1024.55,-1141.7 1029.5,-1146.65"/>
</g>
<!-- status -->
<g id="node7" class="node">
<title>status</title>
<polygon fill="none" stroke="black" points="1213.37,-1137.57 1123.37,-1137.57 1123.37,-1101.57 1213.37,-1101.57 1213.37,-1137.57"/>
<text text-anchor="middle" x="1168.37" y="-1115.37" font-family="Times,serif" font-size="14.00">status: Status</text>
</g>
<!-- SSTableBuilder -->
<g id="node8" class="node">
<title>SSTableBuilder</title>
<polygon fill="none" stroke="black" points="1679.55,-1137.57 1284.98,-1137.57 1284.98,-1101.57 1679.55,-1101.57 1679.55,-1137.57"/>
<text text-anchor="middle" x="1482.27" y="-1115.37" font-family="Times,serif" font-size="14.00">new SSTableBuilder(options, (await status.promise) as FileHandle)</text>
</g>
<!-- status&#45;&gt;SSTableBuilder -->
<g id="edge9" class="edge">
<title>status&#45;&gt;SSTableBuilder</title>
<path fill="none" stroke="black" d="M1213.35,-1119.57C1230.7,-1119.57 1251.86,-1119.57 1274.61,-1119.57"/>
<polygon fill="black" stroke="black" points="1274.81,-1123.07 1284.81,-1119.57 1274.81,-1116.07 1274.81,-1123.07"/>
</g>
<!-- builder -->
<g id="node11" class="node">
<title>builder</title>
<polygon fill="none" stroke="black" points="2928.21,-1084.03 2775.25,-1084.03 2775.25,-1048.03 2928.21,-1048.03 2928.21,-1084.03"/>
<text text-anchor="middle" x="2851.73" y="-1061.83" font-family="Times,serif" font-size="14.00">builder: SSTableBuilder</text>
</g>
<!-- SSTableBuilder&#45;&gt;builder -->
<g id="edge10" class="edge">
<title>SSTableBuilder&#45;&gt;builder</title>
<path fill="none" stroke="black" d="M1679.57,-1111.86C1982.42,-1100.02 2549.43,-1077.85 2765.29,-1069.41"/>
<polygon fill="black" stroke="black" points="2765.44,-1072.9 2775.3,-1069.02 2765.17,-1065.91 2765.44,-1072.9"/>
</g>
<!-- hasSmallestSet -->
<g id="node9" class="node">
<title>hasSmallestSet</title>
<polygon fill="none" stroke="black" points="3295.3,-804.28 3197.2,-786.28 3295.3,-768.28 3393.39,-786.28 3295.3,-804.28"/>
<text text-anchor="middle" x="3295.3" y="-782.08" font-family="Times,serif" font-size="14.00">hasSmallestSet</text>
</g>
<!-- internalKey -->
<g id="node12" class="node">
<title>internalKey</title>
<polygon fill="none" stroke="black" points="3362.68,-280.26 3186.94,-280.26 3186.94,-244.26 3362.68,-244.26 3362.68,-280.26"/>
<text text-anchor="middle" x="3274.81" y="-258.06" font-family="Times,serif" font-size="14.00">InternalKey.from(entry.key)</text>
</g>
<!-- hasSmallestSet&#45;&gt;internalKey -->
<g id="edge12" class="edge">
<title>hasSmallestSet&#45;&gt;internalKey</title>
<path fill="none" stroke="black" d="M3294.59,-768.24C3291.56,-690.69 3279.62,-385.3 3275.91,-290.49"/>
<polygon fill="black" stroke="black" points="3279.41,-290.35 3275.52,-280.5 3272.42,-290.62 3279.41,-290.35"/>
</g>
<!-- entry -->
<g id="node10" class="node">
<title>entry</title>
<polygon fill="none" stroke="black" points="1954.82,-879.57 1687.88,-879.57 1687.88,-843.57 1954.82,-843.57 1954.82,-879.57"/>
<text text-anchor="middle" x="1821.35" y="-857.37" font-family="Times,serif" font-size="14.00">entry: {key: Uint8Array, value: Uint8Array}</text>
</g>
<!-- builder&#45;&gt;hasSmallestSet -->
<g id="edge11" class="edge">
<title>builder&#45;&gt;hasSmallestSet</title>
<path fill="none" stroke="black" d="M2880.49,-1047.89C2959.98,-997.76 3182.17,-857.62 3264.29,-805.84"/>
<polygon fill="black" stroke="black" points="3266.55,-808.55 3273.14,-800.25 3262.81,-802.63 3266.55,-808.55"/>
</g>
<!-- builderFinish -->
<g id="node16" class="node">
<title>builderFinish</title>
<polygon fill="none" stroke="black" points="2858.37,-1253.8 2760.56,-1235.8 2858.37,-1217.8 2956.18,-1235.8 2858.37,-1253.8"/>
<text text-anchor="middle" x="2858.37" y="-1231.6" font-family="Times,serif" font-size="14.00">builder.finish()</text>
</g>
<!-- builder&#45;&gt;builderFinish -->
<g id="edge17" class="edge">
<title>builder&#45;&gt;builderFinish</title>
<path fill="none" stroke="black" d="M2852.44,-1084.2C2853.6,-1113.81 2855.9,-1172.69 2857.27,-1207.72"/>
<polygon fill="black" stroke="black" points="2853.78,-1207.91 2857.67,-1217.77 2860.77,-1207.64 2853.78,-1207.91"/>
</g>
<!-- metaSmallest -->
<g id="node13" class="node">
<title>metaSmallest</title>
<polygon fill="none" stroke="black" points="2856.85,-36 2764.66,-36 2764.66,0 2856.85,0 2856.85,-36"/>
<text text-anchor="middle" x="2810.76" y="-13.8" font-family="Times,serif" font-size="14.00">meta.smallest</text>
</g>
<!-- internalKey&#45;&gt;metaSmallest -->
<g id="edge13" class="edge">
<title>internalKey&#45;&gt;metaSmallest</title>
<path fill="none" stroke="black" d="M3240.31,-244.1C3157.15,-200.33 2945.76,-89.06 2854.17,-40.85"/>
<polygon fill="black" stroke="black" points="2855.65,-37.67 2845.17,-36.11 2852.39,-43.87 2855.65,-37.67"/>
</g>
<!-- metaLargest -->
<g id="node14" class="node">
<title>metaLargest</title>
<polygon fill="none" stroke="black" points="2409.22,-315.75 2325.16,-315.75 2325.16,-279.75 2409.22,-279.75 2409.22,-315.75"/>
<text text-anchor="middle" x="2367.19" y="-293.55" font-family="Times,serif" font-size="14.00">meta.largest</text>
</g>
<!-- metaSmallest&#45;&gt;metaLargest -->
<g id="edge14" class="edge">
<title>metaSmallest&#45;&gt;metaLargest</title>
<path fill="none" stroke="black" d="M2781.99,-36.14C2704.49,-85.02 2491.31,-219.47 2404.61,-274.15"/>
<polygon fill="black" stroke="black" points="2402.48,-271.36 2395.89,-279.65 2406.21,-277.28 2402.48,-271.36"/>
</g>
<!-- add -->
<g id="node15" class="node">
<title>add</title>
<polygon fill="none" stroke="black" points="2387.68,-839.77 2149.01,-821.77 2387.68,-803.77 2626.34,-821.77 2387.68,-839.77"/>
<text text-anchor="middle" x="2387.68" y="-817.57" font-family="Times,serif" font-size="14.00">await builder.add(entry.key, entry.value)</text>
</g>
<!-- metaLargest&#45;&gt;add -->
<g id="edge15" class="edge">
<title>metaLargest&#45;&gt;add</title>
<path fill="none" stroke="black" d="M2367.9,-315.79C2370.93,-393.34 2382.87,-698.79 2386.58,-793.56"/>
<polygon fill="black" stroke="black" points="2383.09,-793.95 2386.98,-803.8 2390.08,-793.67 2383.09,-793.95"/>
</g>
<!-- add&#45;&gt;builder -->
<g id="edge16" class="edge">
<title>add&#45;&gt;builder</title>
<path fill="none" stroke="black" d="M2417.77,-837.6C2497.66,-879.65 2715.33,-994.23 2808.49,-1043.27"/>
<polygon fill="black" stroke="black" points="2806.89,-1046.38 2817.37,-1047.94 2810.15,-1040.19 2806.89,-1046.38"/>
</g>
<!-- fileSize -->
<g id="node17" class="node">
<title>fileSize</title>
<polygon fill="none" stroke="black" points="2964.01,-1518.65 2773.45,-1518.65 2773.45,-1482.65 2964.01,-1482.65 2964.01,-1518.65"/>
<text text-anchor="middle" x="2868.73" y="-1496.45" font-family="Times,serif" font-size="14.00">meta.fileSize = builder.fileSize</text>
</g>
<!-- builderFinish&#45;&gt;fileSize -->
<g id="edge18" class="edge">
<title>builderFinish&#45;&gt;fileSize</title>
<path fill="none" stroke="black" d="M2859.08,-1254.01C2860.86,-1299.37 2865.48,-1417.69 2867.62,-1472.28"/>
<polygon fill="black" stroke="black" points="2864.12,-1472.46 2868.01,-1482.31 2871.12,-1472.19 2864.12,-1472.46"/>
</g>
<!-- assert -->
<g id="node18" class="node">
<title>assert</title>
<polygon fill="none" stroke="black" points="2954.29,-1761.88 2802.18,-1761.88 2802.18,-1725.88 2954.29,-1725.88 2954.29,-1761.88"/>
<text text-anchor="middle" x="2878.24" y="-1739.68" font-family="Times,serif" font-size="14.00">assert(meta.fileSize &gt; 0)</text>
</g>
<!-- fileSize&#45;&gt;assert -->
<g id="edge19" class="edge">
<title>fileSize&#45;&gt;assert</title>
<path fill="none" stroke="black" d="M2869.44,-1518.93C2871.09,-1561.03 2875.15,-1665.05 2877.13,-1715.52"/>
<polygon fill="black" stroke="black" points="2873.64,-1715.86 2877.53,-1725.71 2880.63,-1715.59 2873.64,-1715.86"/>
</g>
<!-- checkTableErrors -->
<g id="node19" class="node">
<title>checkTableErrors</title>
<polygon fill="none" stroke="black" points="2989.86,-2011.64 2786.14,-2011.64 2786.14,-1975.64 2989.86,-1975.64 2989.86,-2011.64"/>
<text text-anchor="middle" x="2888" y="-1989.44" font-family="Times,serif" font-size="14.00">// TODO check if table has errors</text>
</g>
<!-- assert&#45;&gt;checkTableErrors -->
<g id="edge20" class="edge">
<title>assert&#45;&gt;checkTableErrors</title>
<path fill="none" stroke="black" d="M2878.95,-1762.24C2880.65,-1805.47 2884.88,-1913.87 2886.9,-1965.48"/>
<polygon fill="black" stroke="black" points="2883.41,-1965.73 2887.3,-1975.59 2890.4,-1965.46 2883.41,-1965.73"/>
</g>
<!-- end -->
<g id="node21" class="node">
<title>end</title>
<ellipse fill="none" stroke="black" cx="2895.84" cy="-2194.17" rx="27" ry="18"/>
<text text-anchor="middle" x="2895.84" y="-2189.97" font-family="Times,serif" font-size="14.00">end</text>
</g>
<!-- checkTableErrors&#45;&gt;end -->
<g id="edge21" class="edge">
<title>checkTableErrors&#45;&gt;end</title>
<path fill="none" stroke="black" d="M2888.71,-2011.79C2890.08,-2046.82 2893.1,-2123.99 2894.74,-2165.84"/>
<polygon fill="black" stroke="black" points="2891.24,-2166.06 2895.13,-2175.92 2898.24,-2165.79 2891.24,-2166.06"/>
</g>
<!-- tableFilename&#45;&gt;status -->
<g id="edge8" class="edge">
<title>tableFilename&#45;&gt;status</title>
<path fill="none" stroke="black" d="M1117.51,-1119.57C1117.63,-1119.57 1117.75,-1119.57 1117.87,-1119.57"/>
<polygon fill="black" stroke="black" points="1113.36,-1123.07 1123.36,-1119.57 1113.36,-1116.07 1113.36,-1123.07"/>
</g>
</g>
</svg>
